peace_options = {

    ceasefire = {
        icon = GFX_decision_hol_exchange_intelligence_data
        cost = 0
        target_trigger = {
            always = no
            has_war_with = FROM
            FROM = {
                is_puppet = no
            }
        }

        days_re_enable = 14

        visible = {
            always = no
            has_war_with = FROM
            is_puppet = no
            has_capitulated = no
            FROM = {
                has_capitulated = no
                is_puppet = no
            }
        }

        available = {
            NOT = {
                has_country_flag = plus_cs_waiting_response
            }
            has_war_with = FROM
            FROM = {
                has_capitulated = no
                is_puppet = no
            }
        }

        complete_effect = {
            #FROM = {
            #    country_event = { id = plus_cs.7 hours = 12 }
            #}
            set_temp_variable = { a = 1 }
            var:global.province_controllers^var:a = {
                add_political_power = 1
            }
            for_each_loop = {
                array = var:global.province_controllers
                add_to_temp_array = {
                    array = cont
                    value = var:v
                    index = var:i
                }
            }
            white_peace = FROM
            set_truce = {
                target = FROM
                days = 14
            }
            for_each_loop = {
                array = var:cont
                index = in
                if = {
                    limit = {
                        NOT = {
                            check_variable = { var:v = var:global.province_controllers^var:in }
                        }
                    }
                    add_political_power = 1
                    log = "[?in] [?v.GetName]"
                    add_to_array = {
                        array = t_prov_scopes@FROM
                        value = var:v
                    }
                    add_to_array = {
                        array = t_prov_indexes@FROM
                        value = var:in
                    }
                }
                var:v = {
                    set_province_controller = var:in
                }
            }
            set_variable = { truce@FROM = 1 }
            set_variable = { FROM.truce@ROOT = 1 }
            every_other_country = {
                limit = {
                    check_variable = { ROOT.t_prov_scopes@THIS^num > 0 }
                }
                log = "FROM IS [?FROM.GetName]"
                for_each_loop = {
                    array = var:ROOT.t_prov_scopes@THIS
                    var:v = {
                        set_province_controller = var:ROOT.t_prov_indexes@THIS^var:i
                    }
                }
            }
        }
    }
}

peace_treaty = {
    ceasefire_end = {
        icon = GFX_decision_hol_exchange_intelligence_data
        cost = 0
        target_trigger = {
            FROM = {
                check_variable = { truce@ROOT = 1 }
            }
        }
        visible = {
            FROM = {
                check_variable = { truce@ROOT = 1 }
            }
        }
        fire_only_once = yes
        is_good = yes
        selectable_mission = no
        days_mission_timeout = 14
        war_with_target_on_timeout = yes

        targeted_modifier = {
            political_power_gain = 0.25
        }

        activation = {
            always = yes
        }

        available = {
            always = no
        }

        timeout_effect = {
            every_other_country = {
                limit = {
                    check_variable = { ROOT.t_prov_scopes@THIS^num > 0 }
                }
                log = "FROM IS [?FROM.GetName]"
                for_each_loop = {
                    array = var:ROOT.t_prov_scopes@THIS
                    log = "DAILY"
                    log = "[?ROOT.t_prov_indexes@THIS^i]"
                    log = "[?v.GetName]"
                    var:v = {
                        set_province_controller = var:ROOT.t_prov_indexes@THIS^var:i
                    }
                }
            }
            if = {
                limit = {
                    check_variable = { original_tag = FROM.original_tag }
                }
                declare_war_on = {
                    target = FROM
                    type = civil_war
                }
                add_civil_war_target = FROM
            }
            else = {
                declare_war_on = {
                    target = FROM
                    type = annex_everything
                }
            }
            set_variable = { truce@FROM = 0 }
            set_variable = { FROM.truce@ROOT = 0 }
        }
    }

    peace_pay_war_reparations = {
        icon = GFX_decision_hol_attract_foreign_investors
        cost = 0
        fire_only_once = yes
        days_remove = 720
        activation = { always = yes }

        is_good = no
        selectable_mission = no

        target_trigger = {
            always = no
        }

        days_mission_timeout = 100
        targeted_modifier = { 
            tag = FROM 
            cic_to_target_factor = 0.14 
            mic_to_target_factor = 0.2
        }

        remove_effect = {
            subtract_from_variable = { wr_payments = 1 }
        }
    }
}